"use strict";(self.webpackChunkbts=self.webpackChunkbts||[]).push([[5822],{25358:(e,t,n)=>{n.d(t,{A:()=>c});n(9950);var a=n(95537),r=n(36233),s=n(93999),o=n(12833),i=n(44414);function c(e){var t=e.activeStep,n=e.steps;return(0,i.jsx)(a.A,{sx:{width:"100%"},children:(0,i.jsx)(r.A,{activeStep:t,alternativeLabel:!0,sx:{".MuiStepIcon-root":{color:"#F2F2F2"}},children:n.map((function(e){return(0,i.jsx)(s.A,{children:(0,i.jsx)(o.A,{children:e})},e)}))})})}},95266:(e,t,n)=>{n.d(t,{A:()=>u});var a=n(64467),r=(n(9950),n(59254)),s=n(95537),o=n(61763),i=n(86551),c=n(44414),l=(0,r.Ay)(o.A)((function(e){var t;e.theme;return t={height:10,borderRadius:0,marginTop:"5px"},(0,a.A)(t,"&.".concat(i.A.colorPrimary),{backgroundColor:"#D3D2D2"}),(0,a.A)(t,"& .".concat(i.A.bar),{borderRadius:5,backgroundColor:"#00AAB5"}),t}));function u(e){return(0,c.jsx)(s.A,{sx:{flexGrow:1},children:(0,c.jsx)(l,{variant:"determinate",value:e.percentage})})}},45822:(e,t,n)=>{n.r(t),n.d(t,{default:()=>T});var a=n(89379),r=n(9950),s=n(14857),o=n(22433),i=n(5544),c=n(95537),l=n(14341),u=n(46565),d=n(4534),p=n(37072),h=n(6445),x=n(97539),m=n(41608),A=n(16673),j=n(4721),f=n(58926),v=n(95266),b=n(29031),_=n(44414);const g=function(e){var t=e.location.state,n=(0,r.useState)(null),s=(0,i.A)(n,2),o=s[0],g=s[1],y=(0,r.useState)(t?t.location.province:null),S=(0,i.A)(y,2),C=S[0],O=S[1],w=(0,r.useState)([]),T=(0,i.A)(w,2),E=T[0],I=T[1],q=(0,r.useState)(t?t.location.city:null),k=(0,i.A)(q,2),V=k[0],J=k[1],W=(0,r.useState)(null),B=(0,i.A)(W,2),M=B[0],P=B[1],z=(0,r.useState)(t?t.project_state.name:null),F=(0,i.A)(z,2),Y=F[0],D=F[1],R=(0,A.useHistory)(),H=(0,b.dh)().enqueueSnackbar;return(0,r.useEffect)((function(){m.A.get("".concat(j.J,"/api/utils/provinces/?country_id=25")).then((function(e){200===e.status&&g(e.data)})).catch((function(e){417===e.response.status?H(e.response.data.error,{variant:"error"}):H("\u0645\u0634\u06a9\u0644\u06cc \u067e\u06cc\u0634 \u0622\u0645\u062f\u0647! \u0644\u0637\u0641\u0627 \u062f\u0648\u0628\u0627\u0631\u0647 \u0633\u0639\u06cc \u06a9\u0646\u06cc\u062f",{variant:"error"})}))}),[]),(0,r.useEffect)((function(){null!==C&&m.A.get("".concat(j.J,"/api/utils/cities/?province__id=").concat(C)).then((function(e){200===e.status&&I(e.data)})).catch((function(e){417===e.response.status?H(e.response.data.error,{variant:"error"}):H("\u0645\u0634\u06a9\u0644\u06cc \u067e\u06cc\u0634 \u0622\u0645\u062f\u0647! \u0644\u0637\u0641\u0627 \u062f\u0648\u0628\u0627\u0631\u0647 \u0633\u0639\u06cc \u06a9\u0646\u06cc\u062f",{variant:"error"})}))}),[C]),(0,r.useEffect)((function(){m.A.get("".concat(j.J,"/api/project/get_project_state")).then((function(e){200===e.status&&P(e.data)})).catch((function(e){417===e.response.status?H(e.response.data.error,{variant:"error"}):H("\u0645\u0634\u06a9\u0644\u06cc \u067e\u06cc\u0634 \u0622\u0645\u062f\u0647! \u0644\u0637\u0641\u0627 \u062f\u0648\u0628\u0627\u0631\u0647 \u0633\u0639\u06cc \u06a9\u0646\u06cc\u062f",{variant:"error"})}))}),[]),(0,_.jsxs)(c.A,{sx:{mt:"20px"},children:[(0,_.jsx)(d.A,{style:{marginRight:"10px"},children:"\u0627\u0637\u0644\u0627\u0639\u0627\u062a \u067e\u0631\u0648\u0698\u0647"}),(0,_.jsx)(v.A,{percentage:33.33}),(0,_.jsx)(h.l1,{initialValues:{name:t?t.name:"",province_name:t?t.location.province_name:"",city_name:t?t.location.city_name:"",status_name:t?t.project_state.label:"",address:t?t.location.address:""},validationSchema:f.Ik().shape({name:f.Yj().required("\u0646\u0627\u0645 \u0627\u062c\u0628\u0627\u0631\u06cc \u0645\u06cc \u0628\u0627\u0634\u062f"),province_name:f.Yj().required("\u0627\u0633\u062a\u0627\u0646 \u0627\u062c\u0628\u0627\u0631\u06cc \u0645\u06cc \u0628\u0627\u0634\u062f"),city_name:f.Yj().required("\u0634\u0647\u0631 \u0627\u062c\u0628\u0627\u0631\u06cc \u0645\u06cc \u0628\u0627\u0634\u062f")}),onSubmit:function(e,n){n.setErrors;var a=n.setSubmitting;t?(a(!0),m.A.post("".concat(j.J,"/api/project/update_project/"),{project_num:t.project_num,province:C,city:V,is_user:!0,name:e.name,address:e.address,state:Y}).then((function(e){200===e.status&&(R.push({pathname:"/project/project/new/2",state:e.data}),a(!1))})).catch((function(e){417===e.response.status?H(e.response.data.error,{variant:"error"}):H("\u0645\u0634\u06a9\u0644\u06cc \u067e\u06cc\u0634 \u0622\u0645\u062f\u0647! \u0644\u0637\u0641\u0627 \u062f\u0648\u0628\u0627\u0631\u0647 \u0633\u0639\u06cc \u06a9\u0646\u06cc\u062f",{variant:"error"})})),a(!1)):(a(!0),m.A.post("".concat(j.J,"/api/project/"),{province:C,city:V,is_user:!0,name:e.name,address:e.address,state:Y}).then((function(e){201===e.status&&(R.push({pathname:"/project/project/new/2",state1:e.data}),a(!1))})).catch((function(e){417===e.response.status?H(e.response.data.error,{variant:"error"}):H("\u0645\u0634\u06a9\u0644\u06cc \u067e\u06cc\u0634 \u0622\u0645\u062f\u0647! \u0644\u0637\u0641\u0627 \u062f\u0648\u0628\u0627\u0631\u0647 \u0633\u0639\u06cc \u06a9\u0646\u06cc\u062f",{variant:"error"})})),a(!1))},children:function(e){var t=e.errors,n=(e.handleBlur,e.handleChange),r=e.handleSubmit,s=e.setFieldValue,i=e.isSubmitting,d=e.touched,h=e.values;return(0,_.jsxs)("form",{noValidate:!0,onSubmit:r,style:{display:"flex",flexDirection:"column",justifyContent:"space-between",padding:"0px",gap:"159px",position:"absolute",width:"90%",height:"90%",left:"20px",top:"67px"},children:[(0,_.jsxs)(c.A,{children:[(0,_.jsxs)(c.A,{sx:{mt:2},children:[(0,_.jsx)(p.A,{children:"\u0646\u0627\u0645 \u067e\u0631\u0648\u0698\u0647"}),(0,_.jsx)(l.A,{placeholder:"\u0646\u0627\u0645 \u067e\u0631\u0648\u0698\u0647",fullWidth:!0,id:"name",value:h.name,onChange:n,error:Boolean(d.name&&t.name),helperText:d.name&&t.name})]}),(0,_.jsxs)(c.A,{sx:{mt:2},children:[(0,_.jsx)(p.A,{children:"\u0648\u0636\u0639\u06cc\u062a"}),M&&(0,_.jsx)(x.A,{disablePortal:!0,fullWidth:!0,options:M,value:h.status_name,renderInput:function(e){return(0,_.jsx)(l.A,(0,a.A)((0,a.A)({},e),{},{placeholder:"\u0648\u0636\u0639\u06cc\u062a",fullWidth:!0,id:"status"}))},onChange:function(e,t){t?(s("status_name",t.label),D(t.name)):s("status_name","")},isOptionEqualToValue:function(e,t){return e.label===t.label},noOptionsText:"\u0645\u0648\u0631\u062f\u06cc \u06cc\u0627\u0641\u062a \u0646\u0634\u062f",sx:{".MuiOutlinedInput-root":{padding:"5px"}}})]}),(0,_.jsxs)(c.A,{sx:{mt:2},children:[(0,_.jsx)(p.A,{children:"\u0627\u0633\u062a\u0627\u0646"}),o&&(0,_.jsx)(x.A,{disablePortal:!0,id:"province",options:o,renderInput:function(e){return(0,_.jsx)(l.A,(0,a.A)((0,a.A)({},e),{},{placeholder:"\u0627\u0633\u062a\u0627\u0646"}))},value:h.province_name,onChange:function(e,t){t?(s("province_name",t.label),O(t.id)):s("province_name","")},isOptionEqualToValue:function(e,t){return e.label===t.label},sx:{".MuiOutlinedInput-root":{padding:"5px"}},noOptionsText:"\u0645\u0648\u0631\u062f\u06cc \u06cc\u0627\u0641\u062a \u0646\u0634\u062f"})]}),(0,_.jsxs)(c.A,{sx:{mt:2},children:[(0,_.jsx)(p.A,{children:"\u0634\u0647\u0631"}),E&&(0,_.jsx)(x.A,{disablePortal:!0,id:"city",options:E,value:h.city_name,renderInput:function(e){return(0,_.jsx)(l.A,(0,a.A)((0,a.A)({},e),{},{placeholder:"\u0634\u0647\u0631"}))},onChange:function(e,t){t?(s("city_name",t.label),J(t.id)):s("city_name","")},isOptionEqualToValue:function(e,t){return e.label===t.label},sx:{".MuiOutlinedInput-root":{padding:"5px"}},noOptionsText:"\u0645\u0648\u0631\u062f\u06cc \u06cc\u0627\u0641\u062a \u0646\u0634\u062f"})]}),(0,_.jsxs)(c.A,{sx:{mt:2},children:[(0,_.jsx)(p.A,{children:"\u0622\u062f\u0631\u0633"}),(0,_.jsx)(l.A,{placeholder:"\u0622\u062f\u0631\u0633",fullWidth:!0,id:"address",multiline:!0,rows:2,value:h.address,onChange:n,error:Boolean(d.address&&t.address),helperText:d.address&&t.address})]})]}),(0,_.jsx)(c.A,{sx:{position:"absolute",bottom:0,width:"100%"},children:(0,_.jsx)(u.A,{disabled:i,loading:i,type:"submit",children:"\u062b\u0628\u062a"})})]})}})]})};var y=n(13045),S=n(38986),C=n(60172),O=n(25358);const w=function(e){var t=e.location.state;console.log("state",e.location.state);var n=(0,r.useState)(null),s=(0,i.A)(n,2),o=s[0],u=s[1],d=(0,r.useState)(t?t.location.province:null),p=(0,i.A)(d,2),v=p[0],g=p[1],w=(0,r.useState)([]),T=(0,i.A)(w,2),E=T[0],I=T[1],q=(0,r.useState)(t?t.location.city:null),k=(0,i.A)(q,2),V=k[0],J=k[1],W=(0,r.useState)(null),B=(0,i.A)(W,2),M=B[0],P=B[1],z=(0,r.useState)(t?t.project_state.name:null),F=(0,i.A)(z,2),Y=F[0],D=F[1],R=(0,b.dh)().enqueueSnackbar,H=(0,A.useHistory)();return(0,r.useEffect)((function(){m.A.get("".concat(j.J,"/api/utils/provinces/?country_id=25")).then((function(e){200===e.status&&u(e.data)})).catch((function(e){417===e.response.status?R(e.response.data.error,{variant:"error"}):R("\u0645\u0634\u06a9\u0644\u06cc \u067e\u06cc\u0634 \u0622\u0645\u062f\u0647! \u0644\u0637\u0641\u0627 \u062f\u0648\u0628\u0627\u0631\u0647 \u0633\u0639\u06cc \u06a9\u0646\u06cc\u062f",{variant:"error"})}))}),[]),(0,r.useEffect)((function(){null!==v&&m.A.get("".concat(j.J,"/api/utils/cities/?province__id=").concat(v)).then((function(e){200===e.status&&I(e.data)})).catch((function(e){417===e.response.status?R(e.response.data.error,{variant:"error"}):R("\u0645\u0634\u06a9\u0644\u06cc \u067e\u06cc\u0634 \u0622\u0645\u062f\u0647! \u0644\u0637\u0641\u0627 \u062f\u0648\u0628\u0627\u0631\u0647 \u0633\u0639\u06cc \u06a9\u0646\u06cc\u062f",{variant:"error"})}))}),[v]),(0,r.useEffect)((function(){m.A.get("".concat(j.J,"/api/project/get_project_state")).then((function(e){200===e.status&&P(e.data)})).catch((function(e){417===e.response.status?R(e.response.data.error,{variant:"error"}):R("\u0645\u0634\u06a9\u0644\u06cc \u067e\u06cc\u0634 \u0622\u0645\u062f\u0647! \u0644\u0637\u0641\u0627 \u062f\u0648\u0628\u0627\u0631\u0647 \u0633\u0639\u06cc \u06a9\u0646\u06cc\u062f",{variant:"error"})}))}),[]),(0,r.useEffect)((function(){var n;!0===(null===(n=e.location.state)||void 0===n?void 0:n.back)&&m.A.get("".concat(j.J,"/api/project/get_project?project_num=").concat(t.project_num)).then((function(e){200===e.status&&console.log("inja",e.data)})).catch((function(e){417===e.response.status?R(e.response.data.error,{variant:"error"}):R("\u0645\u0634\u06a9\u0644\u06cc \u067e\u06cc\u0634 \u0622\u0645\u062f\u0647! \u0644\u0637\u0641\u0627 \u062f\u0648\u0628\u0627\u0631\u0647 \u0633\u0639\u06cc \u06a9\u0646\u06cc\u062f",{variant:"error"})}))}),[]),(0,_.jsxs)(c.A,{sx:{mt:"80px",ml:"120px",width:"400px",background:"white",padding:"20px",height:"550px",borderRadius:"8px"},children:[(0,_.jsx)(S.A,{style:{marginRight:"10px",fontSize:"14px"},children:"\u0627\u0637\u0644\u0627\u0639\u0627\u062a \u067e\u0631\u0648\u0698\u0647"}),(0,_.jsx)(O.A,{activeStep:0,steps:["","",""]}),(0,_.jsx)(h.l1,{initialValues:{name:t?t.name:"",province_name:t?t.location.province_name:"",city_name:t?t.location.city_name:"",status_name:t?t.project_state.label:"",address:t?t.location.address:""},validationSchema:f.Ik().shape({name:f.Yj().required("\u0646\u0627\u0645 \u0627\u062c\u0628\u0627\u0631\u06cc \u0645\u06cc \u0628\u0627\u0634\u062f"),province_name:f.Yj().required("\u0627\u0633\u062a\u0627\u0646 \u0627\u062c\u0628\u0627\u0631\u06cc \u0645\u06cc \u0628\u0627\u0634\u062f"),city_name:f.Yj().required("\u0634\u0647\u0631 \u0627\u062c\u0628\u0627\u0631\u06cc \u0645\u06cc \u0628\u0627\u0634\u062f")}),onSubmit:function(e,n){n.setErrors;var a=n.setSubmitting;t?(a(!0),m.A.post("".concat(j.J,"/api/project/update_project/"),{project_num:t.project_num,province:v,city:V,is_user:!0,name:e.name,address:e.address,state:Y}).then((function(e){200===e.status&&(H.push({pathname:"/project/project/new/2",state:e.data}),a(!1))})).catch((function(e){417===e.response.status?R(e.response.data.error,{variant:"error"}):R("\u0645\u0634\u06a9\u0644\u06cc \u067e\u06cc\u0634 \u0622\u0645\u062f\u0647! \u0644\u0637\u0641\u0627 \u062f\u0648\u0628\u0627\u0631\u0647 \u0633\u0639\u06cc \u06a9\u0646\u06cc\u062f",{variant:"error"})})),a(!1)):(a(!0),m.A.post("".concat(j.J,"/api/project/"),{province:v,city:V,is_user:!0,name:e.name,address:e.address,state:Y}).then((function(e){201===e.status&&(H.push({pathname:"/project/project/new/2",state:e.data}),a(!1))})).catch((function(e){417===e.response.status?R(e.response.data.error,{variant:"error"}):R("\u0645\u0634\u06a9\u0644\u06cc \u067e\u06cc\u0634 \u0622\u0645\u062f\u0647! \u0644\u0637\u0641\u0627 \u062f\u0648\u0628\u0627\u0631\u0647 \u0633\u0639\u06cc \u06a9\u0646\u06cc\u062f",{variant:"error"})})),a(!1))},children:function(e){var t=e.errors,n=(e.handleBlur,e.handleChange),r=e.handleSubmit,s=e.setFieldValue,i=e.isSubmitting,u=e.touched,d=e.values;return(0,_.jsxs)("form",{noValidate:!0,onSubmit:r,style:{display:"flex",flexDirection:"column",justifyContent:"space-between",padding:"0px",height:"440px"},children:[(0,_.jsxs)(c.A,{children:[(0,_.jsxs)(c.A,{sx:{mt:1},children:[(0,_.jsx)(C.A,{style:{fontSize:"12px"},children:"\u0646\u0627\u0645 \u067e\u0631\u0648\u0698\u0647"}),(0,_.jsx)(l.A,{placeholder:"\u0646\u0627\u0645 \u067e\u0631\u0648\u0698\u0647",fullWidth:!0,id:"name",value:d.name,onChange:n,error:Boolean(u.name&&t.name),helperText:u.name&&t.name})]}),(0,_.jsxs)(c.A,{sx:{mt:1},children:[(0,_.jsx)(C.A,{style:{fontSize:"12px"},children:"\u0648\u0636\u0639\u06cc\u062a"}),M&&(0,_.jsx)(x.A,{disablePortal:!0,fullWidth:!0,options:M,value:d.status_name,renderInput:function(e){return(0,_.jsx)(l.A,(0,a.A)((0,a.A)({},e),{},{placeholder:"\u0648\u0636\u0639\u06cc\u062a",fullWidth:!0,id:"status"}))},onChange:function(e,t){t?(s("status_name",t.label),D(t.name)):s("status_name","")},isOptionEqualToValue:function(e,t){return e.label===t.label},noOptionsText:"\u0645\u0648\u0631\u062f\u06cc \u06cc\u0627\u0641\u062a \u0646\u0634\u062f",sx:{".MuiOutlinedInput-root":{padding:"5px"}}})]}),(0,_.jsxs)(c.A,{sx:{mt:1},children:[(0,_.jsx)(C.A,{style:{fontSize:"12px"},children:"\u0627\u0633\u062a\u0627\u0646"}),o&&(0,_.jsx)(x.A,{disablePortal:!0,id:"province",options:o,renderInput:function(e){return(0,_.jsx)(l.A,(0,a.A)((0,a.A)({},e),{},{placeholder:"\u0627\u0633\u062a\u0627\u0646"}))},value:d.province_name,onChange:function(e,t){t?(s("province_name",t.label),g(t.id)):s("province_name","")},isOptionEqualToValue:function(e,t){return e.label===t.label},sx:{".MuiOutlinedInput-root":{padding:"5px"}},noOptionsText:"\u0645\u0648\u0631\u062f\u06cc \u06cc\u0627\u0641\u062a \u0646\u0634\u062f"})]}),(0,_.jsxs)(c.A,{sx:{mt:1},children:[(0,_.jsx)(C.A,{style:{fontSize:"12px"},children:"\u0634\u0647\u0631"}),E&&(0,_.jsx)(x.A,{disablePortal:!0,id:"city",options:E,value:d.city_name,renderInput:function(e){return(0,_.jsx)(l.A,(0,a.A)((0,a.A)({},e),{},{placeholder:"\u0634\u0647\u0631"}))},onChange:function(e,t){t?(s("city_name",t.label),J(t.id)):s("city_name","")},isOptionEqualToValue:function(e,t){return e.label===t.label},sx:{".MuiOutlinedInput-root":{padding:"5px"}},noOptionsText:"\u0645\u0648\u0631\u062f\u06cc \u06cc\u0627\u0641\u062a \u0646\u0634\u062f"})]}),(0,_.jsxs)(c.A,{sx:{mt:1},children:[(0,_.jsx)(C.A,{style:{fontSize:"12px"},children:"\u0622\u062f\u0631\u0633"}),(0,_.jsx)(l.A,{placeholder:"\u0622\u062f\u0631\u0633",fullWidth:!0,id:"address",multiline:!0,rows:2,value:d.address,onChange:n,error:Boolean(u.address&&t.address),helperText:u.address&&t.address})]})]}),(0,_.jsx)(c.A,{sx:{},children:(0,_.jsx)(y.A,{disabled:i,loading:i,type:"submit",children:"\u062b\u0628\u062a"})})]})}})]})};const T=function(e){var t=(0,s.A)(),n=(0,o.A)(t.breakpoints.down("md"));return(0,_.jsx)(_.Fragment,{children:n?(0,_.jsx)(g,(0,a.A)({},e)):(0,_.jsx)(w,(0,a.A)({},e))})}}}]);